{"version":3,"file":"app-build/webConnection.js","sources":["app/webConnection.js","@traceur/generated/TemplateParser/6","@traceur/generated/TemplateParser/4","@traceur/generated/TemplateParser/1","@traceur/generated/TemplateParser/2","@traceur/generated/TemplateParser/5","@traceur/generated/TemplateParser/0","@traceur/generated/TemplateParser/10"],"names":[],"mappings":"AAmBA;ACnBA,KAAK,iBAAiB,AAAC,CAAC,OAAM;SCA9B,EAAC,GAAE,YCAqB;AAAE,uBAAwB;IAAE,ADA9B,CAAC;AEAvB,WAAS,CCAT,EAAC,KAAI,CDAO,KAAG,ACAS,CAAC;CJAyB,CAAC;;ADmBnD,AAAI,EAAA,CAAA,GAAE,EAAI,CAAA,OAAM,AAAC,CAAC,eAAc,CAAC,CAAC;AAGlC,MAAM,IAAI,AAAC,CAAC,wBAAuB,CAAC,CAAC;AAUrC,AAAI,EAAA,CAAA,EAAC,EAAI,CAAA,GAAE,GAAG,CAAC;EAIP,UAAQ,EMpChB,EAAC,gBAAoB,CAAA,OAAM,AAAC,eAAkB,CACtC,CAAA,iBAAqB,0BAA2B,CAAA,iBAAqB,GAAK,EAAC,OAAM,gBAAmB,CAD9D,AAC+D,CAAC;ANqC9G,AAAI,EAAA,CAAA,cAAa,EAAI,KAAG,CAAC;AAEzB,AAAI,EAAA,CAAA,KAAI,EAAI,CAAA,OAAM,AAAC,CAAC,SAAQ,CAAC,CAAC;AAE9B,AAAI,EAAA,CAAA,WAAU,EAAI,CAAA,KAAI,WAAW,AAAC,CAAC,SAAS,IAAG;AAE7C,GAAC,GAAG,AAAC,CAAC,YAAW,CAAG,UAAS,MAAK;AAChC,AAAI,MAAA,CAAA,QAAO,EAAI,KAAG,CAAC;AACnB,UAAM,IAAI,AAAC,CAAC,oBAAmB,CAAC,CAAC;AACjC,AAAI,MAAA,CAAA,eAAc,EAAI,UAAS,AAAc,CAAG;QAAjB,WAAS,6CAAE,KAAG;AAC3C,SAAI,UAAS,GAAK,KAAG;AACnB,qBAAa,EAAI,WAAS,CAAC;AAAA,AAE7B,WAAK,KAAK,AAAC,CAAC,YAAW,CAAG,eAAa,CAAC,CAAC;IAC3C,CAAC;AACD,cAAU,AAAC,CAAC,SAAQ,AAAC,CAAE;AACrB,WAAK,KAAK,AAAC,CAAC,MAAK,CAAE,OAAK,CAAC,CAAC;IAC5B,CAAG,MAAI,CAAC,CAAA;AACR,SAAK,GAAG,AAAC,CAAC,mBAAkB,CAAG,UAAQ,AAAC,CAAE;AACxC,YAAM,IAAI,AAAC,CAAC,mBAAkB,CAAG,eAAa,CAAC,CAAC;AAChD,oBAAc,AAAC,EAAC,CAAC;IACnB,CAAC,CAAC;AAEF,SAAK,GAAG,AAAC,CAAC,SAAQ,CAAG,UAAS,GAAE,CAAE;AAChC,YAAM,IAAI,AAAC,CAAC,mBAAkB,CAAG,IAAE,CAAC,CAAC;AACrC,aAAO,EAAI,CAAA,GAAE,OAAO,CAAC;AACrB,AAAI,QAAA,CAAA,GAAE,EAAE,CAAA,SAAQ,IAAI,AAAC,CAAC,QAAO,CAAC,CAAC;AAC/B,YAAM,IAAI,AAAC,CAAC,cAAa,CAAE,IAAE,CAAC,CAAC;AAC/B,WAAK,KAAK,AAAC,CAAC,MAAK,CAAE,IAAE,CAAC,CAAC;IACzB,CAAC,CAAC;AAWF,SAAK,GAAG,AAAC,CAAC,YAAW,CAAG,UAAS,GAAE,CAAE;AACnC,YAAM,IAAI,AAAC,CAAC,WAAU,CAAG,IAAE,CAAC,CAAC;AAC7B,SAAG,AAAC,CAAC;AAAC,aAAK,CAAE,CAAA,GAAE,OAAO;AAAG,WAAG,CAAE,CAAA,GAAE,KAAK;AAAA,MAAC,CAAC,CAAC;IAC1C,CAAC,CAAC;EACJ,CAAC,CAAC;AACJ,CAAC,CAAC;AAEF,MAAM,IAAI,AAAC,CAAC,WAAU,CAAE,YAAU,CAAC,CAAC;AAMpC,AAAI,EAAA,CAAA,eAAc,EAAI,UAAS,AAAc,CAAG;IAAjB,WAAS,6CAAE,KAAG;AAC3C,KAAI,UAAS,GAAK,KAAG;AACnB,iBAAa,EAAI,WAAS,CAAC;AAAA,AAE7B,QAAM,IAAI,AAAC,CAAC,EAAC,KAAK,CAAC,CAAC;AACpB,GAAC,QAAQ,KAAK,AAAC,CAAC,YAAW,CAAG,eAAa,CAAC,CAAC;AAC7C,QAAM,IAAI,AAAC,CAAC,SAAQ,CAAC,CAAC;AACxB,CAAA;AAEA,AAAI,EAAA,CAAA,YAAW,EAAI,UAAS,QAAO;AAEjC,SAAO,SAAS,AAAC,CAAC,GAAE,CAAC,QAAQ,AAAC,EAAC,SAAC,CAAA,CAAM;AACpC,KAAC,KAAK,AAAC,CAAC,MAAK,CAAE,EAAA,CAAC,CAAA;EAChB,EAAC,CAAC;AACN,CAAA;AAGA,AAAI,EAAA,CAAA,YAAW,EAAI,IAAI,CAAA,KAAI,IAAI,AAAC,EAAC,CAAC;AAElC,WAAW,QAAQ,AAAC,EAAC,SAAC,CAAA,CAAM;AAC1B,GAAC,QAAQ,KAAK,AAAC,CAAC,gBAAe,CAAE,EAAA,CAAC,CAAC;AACrC,EAAC,CAAA;AAED,AAAI,EAAA,CAAA,gBAAe,EAAI,IAAI,CAAA,KAAI,IAAI,AAAC,EAAC,CAAC;AACtC,eAAe,OAAO,AAAC,EAAC,SAAC,CAAA;OAAM,EAAC,CAAA,cAAc;AAAA,EAAC,QAAQ,AAAC,EAAC,SAAC,CAAA,CAAM;AAG9D,GAAC,QAAQ,KAAK,AAAC,CAAC,eAAc,CAAE;AAAC,QAAI,CAAE,CAAA,CAAA,MAAM;AAAG,OAAG,CAAE,CAAA,CAAA,KAAK;AAAG,OAAG,CAAE,CAAA,CAAA,KAAK;AAAE,UAAM,CAAE,CAAA,CAAA,QAAQ;AAAG,WAAO,CAAE,CAAA,CAAA,SAAS;AAAG,gBAAY,CAAG,CAAA,CAAA,cAAc;AAAA,EAAC,CAAC,CAAC;AACnJ,EAAC,CAAA;AOvHD,AAAI,EAAA,CAAA,UAAS,EPyHE;AAAC,SAAO,CAAG,YAAU;AAAG,gBAAc,CAAG,gBAAc;AAAG,aAAW,CAAE,aAAW;AAAG,aAAW,CAAX,aAAW;AAAG,iBAAe,CAAf,iBAAe;AOzHhG,APyHgG,AAAC,COzHjG;AP2HjC,MAAM,IAAI,AAAC,CAAC,UAAS,CAAC,CAAC;AACvB","sourceRoot":"app-build/","sourcesContent":["//var traceur = require(\"traceur\");\n//\n// console.log(traceur);\n\n//var socket = require( 'koa-socket' );\n\n\n\n// $ GET /package.json\n//app.use(serve('.'));\n\n\n\n// $ GET /hello.txt\n//app.use(serve('./browser-build'));\n\n// or use absolute paths\n//app.use(serve(__dirname + '/test/fixtures'));\n\nvar srv = require(\"../web/server\");\n\n\nconsole.log('listening on port 8000');\n\n// socket.start(app);\n//\n// socket.on('join', function(data){\n//   console.log(\"client connect\");\n//   console.log( 'join event fired', data );\n// });\n\n\nvar io = srv.io;\n\n// console.log(io);\n\nimport {codeStore} from \"./codeStore\";\n\nvar generatorStore = null;\n\nvar Bacon = require(\"baconjs\");\n\nvar baconStream = Bacon.fromBinder(function(sink) {\n\n  io.on('connection', function(socket){\n    var deviceId = null;\n    console.log('a device connected');\n    var generatorUpdate = function(generators=null) {\n      if (generators != null)\n        generatorStore = generators;\n      // console.log(\"emitting generators\", generatorStore);\n      socket.emit(\"generators\", generatorStore);\n    };\n    setInterval(function() {\n      socket.emit(\"ping\",\"ping\");\n    }, 30000)\n    socket.on(\"requestGenerators\", function() {\n      console.log(\"requestGenerators\", generatorStore);\n      generatorUpdate();\n    });\n\n    socket.on('getCode', function(msg){\n      console.log('getCode message: ', msg);\n      deviceId = msg.device;\n      var res=codeStore.get(deviceId);\n      console.log(\"sending code\",res);\n      socket.emit(\"code\",res);\n    });\n\n    // socket.on('getDevices', function(msg){\n    //   console.log('getDevices message: ', msg);\n    //   var res=codeStore.get(deviceId);\n    //   console.log(\"sending code\",res);\n    //   socket.emit(\"code\",res);\n    //\n    // });\n\n    //socket.emit(\"code\", \"something is going on\\n is going on!!\");\n    socket.on('codeChange', function(msg){\n      console.log('message: ', msg);\n      sink({device:msg.device, code:msg.code});\n    });\n  });\n});\n\nconsole.log(\"exporting\",baconStream);\n\n// baconStream.onValue(function(v) {\n//   console.log(\"baconVal\",v);\n// });\n\nvar generatorUpdate = function(generators=null) {\n  if (generators != null)\n    generatorStore = generators;\n  // console.log(\"emitting generators\", generatorStore);\n  console.log(io.emit);\n  io.sockets.emit(\"generators\", generatorStore);\n  console.log(\"emitted\");\n}\n\nvar beatFeedback = function(beatInfo) {\n\n  beatInfo.throttle(100).onValue((v) => {\n    io.emit(\"beat\",v)\n    });\n}\n\n\nvar remoteLogger = new Bacon.Bus();\n\nremoteLogger.onValue((v) => {\n  io.sockets.emit(\"consoleMessage\",v);\n})\n\nvar sequenceFeedback = new Bacon.Bus();\nsequenceFeedback.filter((v) => !v.automationVal).onValue((v) => {\n  //console.log(v);\n\n  io.sockets.emit(\"sequenceEvent\",{pitch:v.pitch, time:v.time, name:v.name,seqName:v.seqName, velocity:v.velocity, automationVal: v.automationVal});\n})\n\nexport default {liveCode: baconStream, generatorUpdate: generatorUpdate, beatFeedback:beatFeedback, remoteLogger, sequenceFeedback};\n\nconsole.log(\"exported\");\n","Object.defineProperties(exports, $__placeholder__0);","{get: $__placeholder__0}","get $__placeholder__0() { return $__placeholder__1; }","__esModule: true","{value: $__placeholder__0}","($__placeholder__0 = require($__placeholder__1),\n        $__placeholder__2 && $__placeholder__3.__esModule && $__placeholder__4 || {default: $__placeholder__5})","var $__default = $__placeholder__0"]}