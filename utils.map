{"version":3,"file":"app-build/utils.js","sources":["app/utils.js","@traceur/generated/TemplateParser/6","@traceur/generated/TemplateParser/4","@traceur/generated/TemplateParser/1","@traceur/generated/TemplateParser/2","@traceur/generated/TemplateParser/5","@traceur/generated/TemplateParser/0","@traceur/generated/TemplateParser/8","@traceur/generated/TemplateParser/7"],"names":[],"mappings":"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","sourceRoot":"app-build/","sourcesContent":["\nimport {wu} from \"./wu\";\n\nvar _ = require(\"lodash\");\n\n// turn function into a function that can be applied to a sequence of values\n// only works for functions with one parameter\nexport var generatorize = function(fn) {\n  return function(...params) {\n    if (params.length == 1)\n      params = params[0]\n\n    // depending on parameter type treat as normal function with regular return value\n    if (!isIterable(params) && !(typeof params === \"function\"))\n      return fn(params);\n\n    return function*() {\n      for (let p of getIterator(params))\n        yield fn(p);\n    }\n  }\n}\n\n\n// Return whether a thing is iterable.\nexport const isIterable = thing => {\n  return thing && typeof thing[wu.iteratorSymbol] === \"function\" && typeof thing != \"string\";\n};\n\n// Get the iterator for the thing or throw an error.\n// TODO: make two functions, one for when we are expecting a tom music type and one for converting outside arguments to iterators\nexport const getIterator = (thing) => {\n  if (isIterable(thing))\n    return thing[wu.iteratorSymbol]();\n  throw new TypeError(\"Not iterable: \" + thing);\n};\n\nexport const fixFloat = (n) => parseFloat(n.toPrecision(12));\nvar objectsCloned=0;\nexport const clone = function(obj) {\n    objectsCloned++;\n    if (objectsCloned%5000==0)\n      console.log(\"cloned\",objectsCloned);\n    if (!(obj instanceof Object)) {\n        return obj;\n    }\n    var descriptors = {};\n    Object.getOwnPropertyNames(obj).forEach(function(name) {\n        var prop = Object.getOwnPropertyDescriptor(obj, name);\n        prop.configurable = true;\n        descriptors[name] = prop;\n    });\n    return Object.create(Object.getPrototypeOf(obj), descriptors);\n};\n\n\n\nexport var addObjectProps=function(eventObject, props, enumerable=true) {\n    if (! props instanceof Object)\n      return props;\n\n    var keys = Object.keys(props);\n    if (keys.length==0)\n      return eventObject;\n\n    var descriptor = {};\n    for (let propN of Object.getOwnPropertyNames(eventObject))\n      descriptor[propN] = Object.getOwnPropertyDescriptor(eventObject, propN);\n    // console.log(eventObject);\n    // console.trace();\n    for (let key of keys) {\n      var value = props[key];\n      if (enumerable && typeof value === \"function\" && value.length <= 1) {\n        if (key != \"toString\" && key != \"valueOf\") {\n          var functor = value;\n          try {\n            value = functor(eventObject);\n            value.functor = functor;\n          } catch (e) {\n            console.error(\"functor evaluating error\",e);\n          }\n        }\n      }\n\n      descriptor[key] = { configurable: true, enumerable: enumerable, value:value};\n    }\n    // console.log(\"adding prop\", descriptor);\n    // var stack = new Error().stack\n    // console.log( stack );\n\n    //descriptor[\"toString\"] = {configurable:true, enumerable:false, value: () => \"{\"+Object.keys(descriptor).filter((k) => k !=\"toString\").map((k) => \"\"+k+\": \"+descriptor[k].value).join(\", \")+\"}\"};\n    var obj = Object.create(Object.getPrototypeOf(eventObject),descriptor);\n    return Object.freeze(obj);\n}\n\nexport var addObjectProp = function(eventObject,name, value, enumerable=true) {\n  //var newObject = clone(eventObject);\n\n//  console.log(\"defined property \",name,\" of \",eventObject,\"with value\",value);\n  if (eventObject[name] === value) {\n    return eventObject;\n  }\n\n  return addObjectProps(eventObject, { [name]: value}, enumerable);\n}\n\nexport var addFuncProp = function(eventObject, name, func) {\n// don't transform functions marked with _func or reserved keyword set\n//if (k != \"set\" && ! k.endsWith(\"_func\") && typeof val == \"function\") {\n\n  // this may be contrary to the general design model but i think function properties should be recreated with every object mutation to get access to the latest stuff\n  // Probably solved in MProperty\n  var jsPropDescriptor = { configurable: true, enumerable: true, get: func};\n  var newObject = clone(eventObject);\n//  console.log(\"adding prop descriptor\",newObject, name, jsPropDescriptor);\n  Object.defineProperty(newObject, name, jsPropDescriptor);\n//  console.log(\"added prop descriptor\");\n//  console.log(\"defined funcproperty \",name,\" of \",eventObject);\n  return newObject;\n}\n\n// stringifying needs to be optimized\nexport var toStringDetailed = function(v) {\n//  console.log(v);\n  //  if (v instanceof Object) {\n      if (!v.isTom) {\n        // console.log(\"stringify\");\n        var stringified = JSON.stringify(v, function(key, val) {\n          if (val.isTom)\n            return toStringDetailed(val);\n          if (key==\"toString\" || key==\"inspect\")\n            return val;\n          if (typeof val === 'function') {\n            return val.toString();\n          }\n          return val;\n        },\"  \");\n        return stringified;\n      }\n  // }\n\n  return \"\"+v;\n}\n\nexport var toStringObject = function(o) {\n  if (typeof o == \"object\") {\n    o.prototype.toString= () => \"tooostring\";\n  }\n  return o;\n}\n\nexport var prettyToString = function(name, args, destFunc) {\n  //destFunc.prototype = _.clone(destFunc.prototype);\n  // console.log(\"tosdetailedtest\", args,args.map(toStringDetailed));\n\n  var args = _.clone(args);\n  var parentNode = args.pop();\n  // if (parentNode != undefined)\n  //   parentNode = parentNode.toString();\n  //console.log(\"PRNT\",parentNode, \"\"+parentNode, args, destFunc);\n\n  // console.log(pa)\n\n  if (parentNode == undefined) {\n    args=[];\n    parentNode = \"\";\n  } else\n  if (!parentNode.isTom) {\n    args=[parentNode];\n    parentNode = \"m\";\n  }\n\n  if (parentNode == \"[object Object]\")\n    parentNode = JSON.stringify(parentNode);\n\n\n  // if (!args || args.length==0)\n\n  var stringReperesentation =   \"\"+parentNode+\".\"+ name+\"(\"+args.map(toStringDetailed).join(\", \")+\")\";\n\n  Object.defineProperty(destFunc,\"toString\", {enumerable:false,value: () => stringReperesentation});\n\n  Object.defineProperty(destFunc,\"inspect\", {enumerable:false,value: () => stringReperesentation});\n  //destFunc.toString = destFunc.prototype.toString;\n//console.log(res.prototype.toString());\n  return destFunc;\n}\n","Object.defineProperties(exports, $__placeholder__0);","{get: $__placeholder__0}","get $__placeholder__0() { return $__placeholder__1; }","__esModule: true","{value: $__placeholder__0}","($__placeholder__0 = require($__placeholder__1),\n        $__placeholder__2 && $__placeholder__3.__esModule && $__placeholder__4 || {default: $__placeholder__5})","\n            for (var $__placeholder__0 = [], $__placeholder__1 = 0;\n                 $__placeholder__2 < arguments.length; $__placeholder__3++)\n              $__placeholder__4[$__placeholder__5] = arguments[$__placeholder__6];","\n        for (var $__placeholder__0 =\n                 $__placeholder__1[\n                     $traceurRuntime.toProperty(Symbol.iterator)](),\n                 $__placeholder__2;\n             !($__placeholder__3 = $__placeholder__4.next()).done; ) {\n          $__placeholder__5;\n          $__placeholder__6;\n        }"]}