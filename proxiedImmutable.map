{"version":3,"file":"app-build/immutable/proxiedImmutable.js","sources":["app/immutable/proxiedImmutable.js","@traceur/generated/TemplateParser/10","@traceur/generated/TemplateParser/8","@traceur/generated/TemplateParser/6","@traceur/generated/TemplateParser/7","@traceur/generated/TemplateParser/9","@traceur/generated/TemplateParser/5","@traceur/generated/TemplateParser/3"],"names":[],"mappings":"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","sourceRoot":"app-build/immutable/","sourcesContent":["var _ = require(\"lodash\");\nvar Proxy = require('harmony-proxy');\n\nconst nothing = {};\n\nconst deleteMe = {\n  DELETED: true\n};\n\n\nconst getFunc = ((target, newProps, name) => {\n  var res = newProps && newProps.hasOwnProperty(name) && newProps.hasOwnProperty(name) ? newProps[name] : target[name];\n  return res === deleteMe ? undefined : res;\n});\n\nconst keysFunc = ((oldKeys, newKeys, newProps) => _.filter(_.union(oldKeys(), newKeys()), (k) => !(newProps[k] == deleteMe)));\n\n\nvar wrapNewProps = (target, newProps, deep) => {\n  // console.log(\"wrapping\",target,\" with newProps\",newProps);\n  // console.log(\"adding \",newProps,\"to\",target)\n\n  const setFunc = (name, val = deleteMe) => wrapNewProps(newProxy, typeof name === \"string\" ? {\n    [name]: val\n  } : name, deep);\n\n  const hasCheck = _.memoize((name) =>\n    (newProps.hasOwnProperty(name) && newProps[name] != deleteMe) || (!newProps.hasOwnProperty(name) && target.hasOwnProperty(name) && target[name] != deleteMe));\n\n  const getPropDescriptor = _.memoize(name =>\n    name === \"set\" ? {\n      value: setFunc,\n      enumerable: false,\n      configurable: true\n    } : (getFunc(target, newProps, name) === undefined ? undefined : {\n      value: getFunc(target, newProps, name),\n      enumerable: true,\n      configurable: true\n    }));\n\n  var newKeysSave = null;\n  const newKeys = function() {\n    if (newKeysSave == null)\n      newKeysSave = Object.keys(newProps);\n    return newKeysSave;\n  }; //Object.keys(newProps);\n\n  var oldKeysSave = null;\n  const oldKeys = function() {\n    if (oldKeysSave == null)\n      oldKeysSave = Object.keys(target);\n    return oldKeysSave;\n  }\n  const handler = {\n    get: (t, name, receiver) => {\n      if (name === \"set\")\n        return setFunc;\n        if (name === \"delete\")\n          return setFunc;\n          if (name === \"isImmutable\")\n            return true;\n            // if (name === \"toString\")\n            //   return () => \"vlaaaa\";\n            return getFunc(target, newProps, name);\n          },\n          set: (...args) => {\n            throw new Error([\"tried mutating immutableTom\", args, \"\" + target]);\n          },\n          has: (t, name) => hasCheck(name),\n          hasOwn: (t, name) => hasCheck(name),\n          iterate: (t) => keysFunc(oldKeys, newKeys, newProps).map(k => getFunc(target, newProps, k)),\n          enumerate: () => keysFunc(oldKeys, newKeys, newProps),\n          preventExtension: () => false,\n          isExtensible: () => true,\n          ownKeys: () => keysFunc(oldKeys, newKeys, newProps),\n          getPropertyNames: () => keysFunc(oldKeys, newKeys, newProps),\n          getOwnPropertyNames: () => keysFunc(oldKeys, newKeys, newProps),\n          getOwnPropertyDescriptor: (t, name) => getPropDescriptor(name),\n          getPrototypeOf: () => nothing,\n          setPrototypeOf: () => {throw new Error([\"tried deleting from immutableTom\", args, target])},\n          deleteProperty: (...args) => {\n            throw [\"tried deleting from immutableTom\", args, target]\n          },\n          defineProperty: (...args) => {\n            throw new Error(\"tried defining a property of immutableTom\")\n          },\n        };\n  const newProxy = new Proxy(target, handler);\n  return newProxy;\n}\n\n// TODO: not using deep yet\nexport const immutableTom = function(initial = {}, deep = false) {\n\n  return wrapNewProps(nothing, initial, deep);\n}\n\nvar assert = require(\"assert\");\n\nvar test1 = immutableTom({\n  bla: 2\n}).set(\"test\", 5);\n\nassert.equal(test1.bla, 2);\nassert.equal(test1.test, 5);\n\nassert.throws(() => test1.x = 2);\n\nassert.throws(() => delete test1.bla);\n\nvar deletedProp = test1.delete(\"bla\");\n\nassert.equal(deletedProp.bla, undefined);\nassert.equal(deletedProp.hasOwnProperty(\"bla\"), false);\n\nconsole.log(\"immutableTom Test1\", test1, test1.test, deletedProp, Object.keys(test1));\n\n// throw \"bye\";\n\n\n\nexport var addObjectProp = (obj, name, val, enumerable) => obj.set(name, val);\nexport var addObjectProps = (obj, props, enumerable) => {\n  // console.log(\"adding to immuuutable\",obj,props,obj.set);\n  props = _.mapValues(props, (value) => (typeof value === \"function\" && value.length <= 1) ? value(obj) : value);\n  return obj.set(props);\n}\n","Object.defineProperties(exports, $__placeholder__0);","{get: $__placeholder__0}","get $__placeholder__0() { return $__placeholder__1; }","__esModule: true","{value: $__placeholder__0}","$__placeholder__0[$traceurRuntime.toProperty($__placeholder__1)]","\n            for (var $__placeholder__0 = [], $__placeholder__1 = 0;\n                 $__placeholder__2 < arguments.length; $__placeholder__3++)\n              $__placeholder__4[$__placeholder__5] = arguments[$__placeholder__6];"]}